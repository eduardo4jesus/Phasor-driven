Provided parameters: main(total_num_epochs=1,freeze_features_epochs=0, batch_size=4)
Model orginal architecture is VGG(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ReLU(inplace=True)
    (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU(inplace=True)
    (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): ReLU(inplace=True)
    (17): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): ReLU(inplace=True)
    (20): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (21): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (22): ReLU(inplace=True)
    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (24): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (25): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (26): ReLU(inplace=True)
    (27): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (28): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (29): ReLU(inplace=True)
    (30): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (31): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): ReLU(inplace=True)
    (33): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (34): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (35): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (36): ReLU(inplace=True)
    (37): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (38): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (39): ReLU(inplace=True)
    (40): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (41): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (42): ReLU(inplace=True)
    (43): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
  (classifier): Sequential(
    (0): Linear(in_features=25088, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=1000, bias=True)
  )
)
Model modified architecture is Sequential(
  (0): Linear(in_features=25088, out_features=4096, bias=True)
  (1): ReLU(inplace=True)
  (2): Dropout(p=0.5, inplace=False)
  (3): Linear(in_features=4096, out_features=4096, bias=True)
  (4): ReLU(inplace=True)
  (5): Dropout(p=0.5, inplace=False)
  (6): Linear(in_features=4096, out_features=10, bias=True)
)
Features not frozen on epoch 0
Training: epoch=0 step=312/12500 loss=0.20816 accuracy=93.37061 runtime_forward_ms=2035.30031 runtime_backward_ms=3471.86422.
Training: epoch=0 step=625/12500 loss=0.14452 accuracy=94.80830 runtime_forward_ms=2035.11693 runtime_backward_ms=3471.73276.
Training: epoch=0 step=938/12500 loss=0.11192 accuracy=96.32587 runtime_forward_ms=2035.07974 runtime_backward_ms=3471.65924.
Training: epoch=0 step=1251/12500 loss=0.13560 accuracy=95.12779 runtime_forward_ms=2035.06721 runtime_backward_ms=3471.68827.
Training: epoch=0 step=1564/12500 loss=0.12312 accuracy=95.76677 runtime_forward_ms=2035.07040 runtime_backward_ms=3471.61307.
Training: epoch=0 step=1877/12500 loss=0.11386 accuracy=96.48562 runtime_forward_ms=2035.07377 runtime_backward_ms=3471.61480.
Training: epoch=0 step=2190/12500 loss=0.10800 accuracy=96.32587 runtime_forward_ms=2035.12166 runtime_backward_ms=3471.77448.
Training: epoch=0 step=2503/12500 loss=0.09854 accuracy=96.72523 runtime_forward_ms=2035.07705 runtime_backward_ms=3471.65632.
Training: epoch=0 step=2816/12500 loss=0.10997 accuracy=96.56549 runtime_forward_ms=2035.09299 runtime_backward_ms=3471.65561.
Training: epoch=0 step=3129/12500 loss=0.11801 accuracy=95.76677 runtime_forward_ms=2035.10187 runtime_backward_ms=3471.70344.
Training: epoch=0 step=3442/12500 loss=0.11511 accuracy=96.56549 runtime_forward_ms=2035.11532 runtime_backward_ms=3471.81748.
Training: epoch=0 step=3755/12500 loss=0.11617 accuracy=96.48562 runtime_forward_ms=2035.11450 runtime_backward_ms=3471.74351.
Training: epoch=0 step=4068/12500 loss=0.09164 accuracy=97.20447 runtime_forward_ms=2035.14494 runtime_backward_ms=3471.92302.
Training: epoch=0 step=4381/12500 loss=0.09029 accuracy=96.88498 runtime_forward_ms=2035.07962 runtime_backward_ms=3471.65318.
Training: epoch=0 step=4694/12500 loss=0.09002 accuracy=96.72523 runtime_forward_ms=2035.06795 runtime_backward_ms=3471.61870.
Training: epoch=0 step=5007/12500 loss=0.09702 accuracy=96.48562 runtime_forward_ms=2035.11782 runtime_backward_ms=3471.76003.
Training: epoch=0 step=5320/12500 loss=0.09344 accuracy=96.64536 runtime_forward_ms=2035.10883 runtime_backward_ms=3471.73833.
Training: epoch=0 step=5633/12500 loss=0.09970 accuracy=96.40575 runtime_forward_ms=2035.07161 runtime_backward_ms=3471.62372.
Training: epoch=0 step=5946/12500 loss=0.07822 accuracy=97.84345 runtime_forward_ms=2035.14515 runtime_backward_ms=3471.93476.
Training: epoch=0 step=6259/12500 loss=0.08471 accuracy=97.20447 runtime_forward_ms=2035.14040 runtime_backward_ms=3471.93285.
Training: epoch=0 step=6572/12500 loss=0.11481 accuracy=95.76677 runtime_forward_ms=2035.11762 runtime_backward_ms=3471.79048.
Training: epoch=0 step=6885/12500 loss=0.07189 accuracy=97.68370 runtime_forward_ms=2035.08455 runtime_backward_ms=3471.68221.
Training: epoch=0 step=7198/12500 loss=0.09599 accuracy=96.48562 runtime_forward_ms=2035.11566 runtime_backward_ms=3471.83947.
Training: epoch=0 step=7511/12500 loss=0.07642 accuracy=97.92332 runtime_forward_ms=2035.11734 runtime_backward_ms=3471.82695.
Training: epoch=0 step=7824/12500 loss=0.07768 accuracy=97.36421 runtime_forward_ms=2035.07601 runtime_backward_ms=3471.59613.
Training: epoch=0 step=8137/12500 loss=0.08217 accuracy=97.28434 runtime_forward_ms=2035.11702 runtime_backward_ms=3471.83018.
Training: epoch=0 step=8450/12500 loss=0.10017 accuracy=96.16613 runtime_forward_ms=2035.11775 runtime_backward_ms=3471.79698.
Training: epoch=0 step=8763/12500 loss=0.09440 accuracy=97.04472 runtime_forward_ms=2035.10758 runtime_backward_ms=3471.79008.
Training: epoch=0 step=9076/12500 loss=0.06896 accuracy=97.68370 runtime_forward_ms=2035.07237 runtime_backward_ms=3471.76228.
Training: epoch=0 step=9389/12500 loss=0.07671 accuracy=97.36421 runtime_forward_ms=2035.10240 runtime_backward_ms=3471.78633.
Training: epoch=0 step=9702/12500 loss=0.06863 accuracy=97.68370 runtime_forward_ms=2035.08610 runtime_backward_ms=3471.74041.
Training: epoch=0 step=10015/12500 loss=0.06878 accuracy=97.92332 runtime_forward_ms=2035.12123 runtime_backward_ms=3471.79426.
Training: epoch=0 step=10328/12500 loss=0.08991 accuracy=97.28434 runtime_forward_ms=2035.11310 runtime_backward_ms=3471.74916.
Training: epoch=0 step=10641/12500 loss=0.05663 accuracy=98.32269 runtime_forward_ms=2035.13908 runtime_backward_ms=3471.84507.
Training: epoch=0 step=10954/12500 loss=0.06989 accuracy=97.92332 runtime_forward_ms=2035.11280 runtime_backward_ms=3471.64060.
Training: epoch=0 step=11267/12500 loss=0.09204 accuracy=97.12460 runtime_forward_ms=2035.07980 runtime_backward_ms=3471.67078.
Training: epoch=0 step=11580/12500 loss=0.09518 accuracy=97.04472 runtime_forward_ms=2035.13225 runtime_backward_ms=3471.84422.
Training: epoch=0 step=11893/12500 loss=0.07191 accuracy=98.08307 runtime_forward_ms=2035.11141 runtime_backward_ms=3471.80675.
Training: epoch=0 step=12206/12500 loss=0.07173 accuracy=97.76358 runtime_forward_ms=2035.10708 runtime_backward_ms=3471.73709.
Validation: epoch=0 training_step=12499 loss=0.23491 accuracy=93.64000 runtime_forward_ms=2034.32805.
--- End of Epoch: epoch=0 duration_training=69440.87485196069 duration_validation=5087.440329350531 training_step=12499 training_loss=0.07173 training_accuracy=97.76358 validation_loss=0.23491 validation_accuracy=93.64000.
